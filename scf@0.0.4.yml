# doc: https://github.com/serverless-components/tencent-scf/blob/master/docs/configure.md

inputs:
  type:
    type: string
    message: '不支持当前类型，支持类型有：【 event , web 】'
    allow:
      - event
      - web
  name:
    type: string
    rules:
      - regex: '^[A-Za-z][\w-_]*[A-Za-z0-9]$'
        message: '名称不合法，只能包含字母、数字、下划线、连字符，以字母开头，以数字或字母结尾'
      - min: 2
        message: '名称过短，长度不能小于2个字符'
      - max: 60
        message: '名称过长，长度不能大于60个字符'
  handler:
    type: string
  runtime:
    type: string
    message: '不支持当前运行时，请参考腾讯语言和运行时支持信息。https://cloud.tencent.com/document/product/583/54977'
    allow:
      - Python2.7
      - Python3.6
      - Nodejs6.10
      - Nodejs8.9
      - Nodejs10.15
      - Nodejs12.16
      - Php5
      - Php7
      - Go1
      - Java8
      - CustomRuntime
  region:
    type: string
    message: '不支持指定的地域 ，请查看腾讯地域列表获取所有支持的地域信息。https://cloud.tencent.com/document/api/583/17238#.E5.9C.B0.E5.9F.9F.E5.88.97.E8.A1.A8'
    allow:
      - ap-beijing
      - ap-chengdu
      - ap-chongqing
      - ap-guangzhou
      - ap-hongkong
      - ap-mumbai
      - ap-seoul
      - ap-shanghai
      - ap-shanghai-fsi
      - ap-shenzhen-fsi
      - ap-singapore
      - ap-tokyo
      - eu-frankfurt
      - na-siliconvalley
      - na-toronto
  memorySize:
    type: number
    min: 64
    max: 3072
    message: '内存大小建议区间为 【 64（MB）, 128（MB）- 3072（MB）】 ，并且以 128 （MB）递增'
    allow:
      - 64
      - 128
      - 256
      - 384
      - 512
      - 640
      - 768
      - 896
      - 1024
      - 1152
      - 1280
      - 1408
      - 1536
      - 1664
      - 1792
      - 1920
      - 2048
      - 2176
      - 2304
      - 2432
      - 2560
      - 2688
      - 2816
      - 2944
      - 3072
    level: 'warning'
  environment:
    type: object
    keys:
      variables:
        type: object
  vpcConfig:
    type: object
    keys:
      vpcId:
        type: string
      subnetId:
        type: string
  deadLetter:
    type: object
    keys:
      Type:
        type: string
        required: true
      Name:
        type: string
        required: true
  timeout:
    type: number
    min: 1
    max: 900
    message: '超时时间建议取值范围为 【 1（秒）- 900（秒）】'
    level: 'warning'
  initTimeout:
    type: number
    min: 1
    max: 30
    message: '函数初始化超时时间建议取值范围为 【 1（秒）-30（秒）】'
    level: 'warning'
  cfs:
    type: array
    items:
      - type: object
        keys:
          cfsId:
            type: string
            required: true
          mountInsId:
            type: string
          localMountDir:
            type: string
            required: true
          remoteMountDir:
            type: string
            required: true
  publicAccess:
    type: boolean
  eip:
    type: boolean
  image:
    type: object
    keys:
      imageUrl:
        type: string
        required: true
        regex: '([a-z0-9-]{5,50}).tencentcloudcr.com\/([a-z-_.0-9]{2,30})\/([a-z0-9-_.\/]{2,200}):([\w-]+)@sha256:(\w+)'
        message: '镜像地址无效，请检查查后重试 【 校验规则：{domain}/{namespace}/{imageName}:{tag}@{digest} 】'
  installDependency:
    type: boolean
  asyncRunEnable:
    type: boolean
  l5Enable:
    type: boolean
  tags:
    type: object
  layers:
    type: array
    items:
      - type: object
        keys:
          name:
            type: string
            required: true
          version:
            type: number
            required: true
  events:
    type: array
    items:
      - type: object
        keys:
          timer:
            type: object
            keys:
              parameters:
                type: object
                required: true
                keys:
                  name:
                    type: string
                  enable:
                    type: boolean
                  cronExpression:
                    type: string
                    required: true
                  argument:
                    type: string
          apigw:
            type: object
            keys:
              parameters:
                type: object
                keys:
                  protocols:
                    type: array
                    items:
                      - type: string
                        message: '不支持该协议，支持的协议有：【 http , https 】'
                        allow:
                          - http
                          - https
                  netTypes:
                    type: array
                    items:
                      - type: string
                        message: '不支持该类型，支持的协议有：【 OUTER , INNER 】'
                        allow:
                          - OUTER
                          - INNER
                  description:
                    type: string
                  environment:
                    type: string
                    message: '不支持该环境，支持的环境有：【  test , prepub , release 】'
                    allow:
                      - release
                      - test
                      - prepub
                  endpoints:
                    type: array
                    required: true
                    items:
                      - type: object
                        keys:
                          path:
                            type: string
                            required: true
                          serviceTimeout:
                            type: number
                            min: 1
                            max: 1800
                            message: '超时时间建议取值范围为 【 1（秒）- 1800（秒）】'
                          method:
                            type: string
                            allow:
                              - 'ANY'
                              - 'GET'
                              - 'HEAD'
                              - 'POST'
                              - 'PUT'
                              - 'DELETE'
                            message: '不支持该类型，支持的类型有【 ANY ， GET , HEAD , POST , PUT , DELETE】'
                          enableCORS:
                            type: boolean
                  serviceId:
                    type: string
                  serviceName:
                    type: string
                    regex: '^[a-zA-Z][a-zA-Z0-9(_)]{0,48}[a-zA-Z0-9]?$'
                    message: '名称不合法，支持 a-z,A-Z,0-9,_, 必须字母开头，字母或者数字结尾，且最长为 50 个字符，'
          cos:
            type: object
            keys:
              parameters:
                type: object
                keys:
                  enable:
                    type: boolean
                  bucket:
                    type: string
                    required: true
                  filter:
                    type: object
                    required: true
                    keys:
                      prefix:
                        type: string
                      suffix:
                        type: string
                  events:
                    required: true
                    type: string
                    message: '不支持此 COS 事件类型，请参腾讯 COS 事件说明文档。https://cloud.tencent.com/document/product/583/9707#cos-.E8.A7.A6.E5.8F.91.E5.99.A8.E5.B1.9E.E6.80.A7'
                    allow:
                      - 'cos:ObjectCreated:*'
                      - 'cos:ObjectCreated:Put'
                      - 'cos:ObjectCreated:Post'
                      - 'cos:ObjectCreated:Copy'
                      - 'cos:ObjectCreated:CompleteMultipartUpload'
                      - 'cos:ObjectCreated:Origin'
                      - 'cos:ObjectCreated:Replication'
                      - 'cos:ObjectRemove:*'
                      - 'cos:ObjectRemove:Delete'
                      - 'cos:ObjectRemove:DeleteMarkerCreated'
                      - 'cos:ObjectRestore:Post'
                      - 'cos:ObjectRestore:Completed'
          ckafka:
            type: object
            keys:
              parameters:
                type: object
                keys:
                  enable:
                    type: boolean
                  name:
                    type: string
                  topic:
                    type: string
                  retry:
                    type: number
                  maxMsgNum:
                    type: number
                    min: 1
                    max: 10000
                    message: '不支持该消息数量，支持的数量范围：【 1 - 10000 】'
                  offset:
                    type: string
                    message: '不支持该类型，支持的类型有【 latest , earliest , timestamp 】'
                    allow:
                      - latest
                      - earliest
                      - timestamp
          cmq:
            type: object
            keys:
              parameters:
                type: object
                keys:
                  enable:
                    type: boolean
                  name:
                    type: string
                    required: true
          cls:
            type: object
            keys:
              parameters:
                type: object
                keys:
                  enable:
                    type: boolean
                  topicId:
                    type: string
                    required: true
                  maxWait:
                    message: '不支持该等待数量，支持的数量范围：【 3 - 300 】'
                    type: number
                    min: 3
                    max: 300
          mps:
            type: object
            keys:
              parameters:
                type: object
                keys:
                  enable:
                    type: boolean
                  type:
                    type: string
                    required: true
                    message: '不支持该类型，支持的类型有【 WorkflowTask , EditMediaTask 】'
                    allow:
                      - WorkflowTask
                      - EditMediaTask
          clb:
            type: object
            keys:
              parameters:
                type: object
                keys:
                  loadBalanceId:
                    type: string
                    required: true
                  protocol:
                    type: string
                    required: true
                    message: '不支持该协议，支持的协议有：【 HTTP , HTTPS 】'
                    allow:
                      - HTTP
                      - HTTPS
                  port:
                    type: number
                    required: true
                  domain:
                    type: string
                    required: true
                  url:
                    type: string
                    required: true
                  weight:
                    message: '不支持该数量，支持的数量范围：【 0 - 100 】'
                    type: number
                    min: 0
                    max: 100
